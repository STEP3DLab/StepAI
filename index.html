<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Step3D — Агрегатор 3D‑услуг</title>
  <meta name="description" content="Step3D — крупнейший российский агрегатор услуг 3D‑моделирования, 3D‑печати, 3D‑сканирования, реверс‑инжиниринга и XR."/>
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0b0b0b" media="(prefers-color-scheme: dark)">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' fill='white'/%3E%3Cpath d='M10 22l22-10 22 10-22 10-22-10zm0 0v20l22 10 22-10V22' stroke='black' fill='none'/%3E%3Ctext x='50%' y='56%' font-family='Inter,Arial' font-size='14' text-anchor='middle'%3EStep3D%3C/text%3E%3C/svg%3E">
  <style>
    :root{--bg:#fff;--fg:#000;--muted:#556;--grid:rgba(0,0,0,.04);--line:rgba(0,0,0,.12);--radius:16px;--shadow:0 4px 24px rgba(0,0,0,.35);--glass:rgba(255,255,255,.55);--font-sans:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial,"Noto Sans",sans-serif;--fs:16px;--lh:1.6;--space-1:4px;--space-2:8px;--space-3:12px;--space-4:16px;--space-5:20px;--space-6:24px;--space-7:32px;--space-8:48px;--space-9:64px;--active-bg:rgba(0,0,0,.08)}
    :root.dark{--bg:#0b0b0b;--fg:#f4f4f4;--muted:rgba(255,255,255,.65);--grid:rgba(255,255,255,.06);--line:rgba(255,255,255,.16);--glass:rgba(0,0,0,.35);--shadow:0 6px 28px rgba(0,0,0,.6);--active-bg:rgba(255,255,255,.08)}
    *{box-sizing:border-box}html,body{height:100%}body{margin:0;background:var(--bg);color:var(--fg);font:400 var(--fs)/var(--lh) var(--font-sans);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;overscroll-behavior-y:none;padding-top:env(safe-area-inset-top);padding-bottom:env(safe-area-inset-bottom)}a{color:inherit;text-decoration:none}
    .wrap{max-width:1180px;margin:0 auto;padding:0 clamp(var(--space-3),4vw,var(--space-6))}
    /* Grid + noise */
    .bg-grid:before,.bg-grid:after{content:"";position:fixed;inset:0;pointer-events:none;z-index:-2}
    .bg-grid:before{background:radial-gradient(1000px 800px at 50% -10%,rgba(0,0,0,.08),transparent),linear-gradient(transparent,transparent 95%,var(--grid) 95%),linear-gradient(90deg,transparent,transparent 95%,var(--grid) 95%);background-size:auto,40px 40px,40px 40px}
    .bg-grid:after{opacity:.03;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)"/></svg>')}
    /* Nav */
    .nav{position:sticky;top:0;backdrop-filter:blur(6px);background:var(--glass);border-bottom:1px solid var(--line);z-index:50}
    .nav .inner{display:flex;align-items:center;justify-content:space-between;height:56px}
    .brand{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;letter-spacing:.22em;text-transform:none;font-size:12px}
    .nav a.link{opacity:.75;margin:0 10px;font-size:14px}.nav a.link:hover{opacity:1}
    .btn{display:inline-flex;align-items:center;gap:.5rem;border:1px solid var(--line);border-radius:999px;padding:8px 14px;font-size:14px;transition:.2s;background:transparent}.btn--primary{background:var(--fg);color:var(--bg);border-color:var(--fg)}.btn:hover{transform:translateY(-1px)}
    /* Sections */
    section{padding:clamp(56px,10vw,96px) 0}
    h1{font-weight:600;letter-spacing:-.02em}h2{font-weight:600;letter-spacing:-.01em}
    .muted{color:rgba(0,0,0,.7)}.soft{color:rgba(0,0,0,.55)}
    .card{border:1px solid var(--line);border-radius:var(--radius);background:transparent;box-shadow:var(--shadow)}.card.pad{padding:var(--space-6)}
    .grid{display:grid;gap:var(--space-5)}.grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}@media (max-width:860px){.grid-2,.grid-3{grid-template-columns:1fr}}
    /* Hero */
    .hero{position:relative;overflow:hidden;min-height:86vh;display:flex;align-items:center;text-align:center}
    .hero h1{font-size:clamp(32px,6vw,56px);line-height:1.1}.hero p{max-width:780px;margin:var(--space-3) auto 0}
    .fx3d{position:absolute;inset:0;pointer-events:none;z-index:-1;opacity:.18}
    .marquee{position:relative;overflow:hidden;margin-top:var(--space-7)}.marquee::before,.marquee::after{content:"";position:absolute;top:0;width:90px;height:100%;z-index:2}.marquee::before{left:0;background:linear-gradient(90deg,var(--bg),transparent)}.marquee::after{right:0;background:linear-gradient(270deg,var(--bg),transparent)}.marquee .row{display:flex;gap:24px;white-space:nowrap;animation:scroll 18s linear infinite;color:var(--muted);text-transform:uppercase;letter-spacing:.22em;font-size:13px}@keyframes scroll{from{transform:translateX(0)}to{transform:translateX(-50%)}}
    /* Services */
    .service{padding:var(--space-6)}.service h3{margin:var(--space-3) 0 var(--space-2);font-size:16px}.sep{height:1px;background:var(--line);margin:var(--space-4) 0}
    /* Estimator */
    .est .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}.chip{border:1px solid var(--line);border-radius:14px;padding:6px 10px;font-size:14px;opacity:.9}.chip.active{background:var(--fg);color:var(--bg);border-color:var(--fg)}.range{width:100%}.est .summary{display:flex;align-items:center;justify-content:space-between;margin-top:10px}
    /* Projects */
    .tools{display:flex;gap:var(--space-3);flex-wrap:wrap;align-items:center}.tag{border:1px solid var(--line);border-radius:14px;padding:6px 10px;font-size:14px;opacity:.9}.tag.active{background:var(--fg);color:var(--bg);border-color:var(--fg)}.search{display:flex;align-items:center;gap:var(--space-2);border:1px solid var(--line);border-radius:12px;padding:var(--space-2) var(--space-3)}.search input{background:transparent;border:0;outline:0;color:var(--fg);width:clamp(120px,30vw,240px)}.project .img{position:relative;aspect-ratio:16/10;background:rgba(0,0,0,.05);border-bottom:1px solid var(--line);overflow:hidden}.project .img::after{content:"";position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.08),transparent);opacity:0;transition:.25s}.project:hover .img::after{opacity:1}.badges{display:flex;gap:var(--space-2);flex-wrap:wrap}.badge{border:1px solid var(--line);border-radius:8px;padding:4px 8px;font-size:12px}
    /* Blog */
    article.post time{font-size:12px;color:rgba(0,0,0,.55)}
    /* Contact */
    .form input,.form textarea{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:transparent;color:var(--fg)}.form input::placeholder,.form textarea::placeholder{color:rgba(0,0,0,.45)}
    /* Footer */
    footer{border-top:1px solid var(--line);padding:36px 0;color:rgba(0,0,0,.65)}
    /* Reveal + a11y */
    .reveal{opacity:0;transform:translateY(16px);transition:opacity .6s ease,transform .6s ease}.reveal.in{opacity:1;transform:none}.skip{position:absolute;left:-9999px;top:auto}.skip:focus{left:16px;top:12px;background:var(--bg);color:var(--fg);border:1px solid var(--line);padding:8px 10px;border-radius:10px;z-index:100}:focus-visible{outline:2px dashed var(--fg);outline-offset:2px}#progress{position:fixed;top:0;left:0;height:2px;background:var(--fg);width:0;z-index:60;transform-origin:left center}
    /* Icons + motion */
    :root.dark .muted{color:rgba(255,255,255,.72)}:root.dark .soft{color:rgba(255,255,255,.58)}@media (min-width:1024px){:root{--fs:17px}}.fact{display:flex;align-items:center;gap:var(--space-3)}.ico{width:22px;height:22px;stroke:currentColor;fill:none;stroke-width:1.6}@keyframes spin{to{transform:rotate(360deg)}}@keyframes dash{to{stroke-dashoffset:-50}}@keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(2px)}}@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-1.5px)}}@keyframes flip{0%,100%{transform:translateX(0)}50%{transform:translateX(2px)}}.ico-cad{animation:spin 12s linear infinite}.ico-scan path{stroke-dasharray:40 10;animation:dash 2.4s linear infinite}.ico-print{animation:bob 2.2s ease-in-out infinite}.ico-xr{animation:float 3s ease-in-out infinite}.ico-rev{animation:spin 8s linear infinite reverse}.ico-edu path:nth-child(2){opacity:.7;animation:flip 2.8s ease-in-out infinite}
    /* Kbar */
    .kbar{position:fixed;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);z-index:80;display:grid;place-items:start center;padding-top:10vh}.kbar[hidden]{display:none}.kbar__box{width:min(680px,92vw);background:var(--bg);color:var(--fg);border:1px solid var(--line);border-radius:14px;box-shadow:var(--shadow);overflow:hidden}.kbar__head{display:flex;align-items:center;gap:10px;padding:10px 12px}.kbar__head svg{width:16px;height:16px}.kbar__input{flex:1;border:0;background:transparent;color:var(--fg);outline:none;font:inherit}.kbar__list{max-height:50vh;overflow:auto;border-top:1px solid var(--line)}.kbar__item{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-top:1px solid var(--line);cursor:pointer}.kbar__item.active{background:var(--active-bg)}.kbar__type{font-size:12px;opacity:.6;margin-left:10px}.svc-ico{width:18px;height:18px;stroke:currentColor;fill:none;stroke-width:1.6}
    /* Mobile nav + utils */
    .burger{display:none}.nav a.link.active{opacity:1;text-decoration:underline;text-underline-offset:6px}.nav .links{display:flex;align-items:center}@media (max-width:860px){.burger{display:inline-flex}.nav .links{display:none;position:fixed;top:56px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--line);padding:12px 16px;flex-direction:column;gap:12px;z-index:55}.nav[data-open="true"] .links{display:flex}}@media (max-width:700px){.est .row{grid-template-columns:1fr}}
    @media (prefers-reduced-motion:reduce){.ico-cad,.ico-print,.ico-xr,.ico-rev,.svc-ico{animation:none!important}.ico-scan path,.ico-edu path:nth-child(2){animation:none!important}.marquee .row{animation:none}.fx3d{display:none}}
    @media print{.nav,.cta,#progress,#fx3d,.marquee,#kbar{display:none!important}section{padding:16px 0}a[href^="http"]:after{content:" (" attr(href) ")";font-size:12px}}
    html{scroll-behavior:smooth}:root{color-scheme:light}:root.dark{color-scheme:dark}
    .form input:invalid,.form textarea:invalid{border-color:rgba(255,0,0,.45)}.copy{border:1px solid var(--line);border-radius:8px;padding:4px 8px;font-size:12px;background:transparent}
  </style>
</head>
<body class="bg-grid">
  <a class="skip" href="#main">Пропустить к контенту</a>
  <div id="progress"></div>
  <header class="nav">
    <div class="wrap inner">
      <a href="#main" class="brand">Step3D</a>
      <button id="menu" class="btn burger" aria-label="Открыть меню" aria-expanded="false" aria-controls="navLinks">Меню</button>
      <nav id="navLinks" class="links">
        <a class="link" href="#about">О нас</a>
        <a class="link" href="#services">Услуги</a>
        <a class="link" href="#estimator">Калькулятор</a>
        <a class="link" href="#projects">Проекты</a>
        <a class="link" href="#blog">Блог</a>
        <a class="link" href="#contact">Контакты</a>
      </nav>
      <div style="display:flex;gap:var(--space-2);align-items:center">
        <button id="searchBtn" class="btn" aria-label="Поиск (⌘K)">Поиск ⌘K</button>
        <button id="theme" class="btn" aria-label="Сменить тему">◐</button>
        <a class="btn btn--primary" href="#estimator" aria-label="Быстрый расчёт">Расчёт ▸</a>
      </div>
    </div>
  </header>

  <main id="main">
    <!-- HERO -->
    <section class="hero wrap reveal in">
      <canvas id="fx3d" class="fx3d" aria-hidden="true"></canvas>
      <div style="width:100%">
        <h1>Ваш проводник в мир 3D‑технологий</h1>
        <p class="muted">Агрегатор 3D‑услуг: моделирование, сканирование, реверс‑инжиниринг, 3D‑печать и XR. AI‑модуль оценивает трудоёмкость и подбирает оптимального исполнителя.</p>
        <div style="margin-top:var(--space-6);display:flex;gap:var(--space-3);justify-content:center;flex-wrap:wrap">
          <a class="btn btn--primary" href="#contact">Оставить заявку</a>
          <a class="btn" id="tgCover" download="Step3D_TG_Cover.svg">Заставка TG</a>
          <button class="btn" id="share">Поделиться</button>
        </div>
        <div class="marquee" aria-hidden="true">
          <div class="row">#мечтай  #учись  #твори  #вдохновляй  #мечтай  #учись  #твори  #вдохновляй</div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="wrap reveal">
      <div class="grid grid-2" style="align-items:start">
        <div>
          <h2 style="font-size:clamp(22px,3vw,28px)">Step3D — сообщество, платформа, экспертиза</h2>
          <p class="muted" style="margin-top:10px">Мы автоматизируем путь от идеи до прототипа: интеллектуальная оценка заказа, подбор исполнителя, контроль качества. Меньше бюрократии, больше результата.</p>
          <ul class="soft" style="margin-top:12px;padding-left:18px">
            <li>КП за 1–2 минуты, прозрачные сроки и цена.</li>
            <li>Инженеры, дизайнеры и чемпионы профмастерства в одной сети.</li>
            <li>Web‑портал и Telegram‑бот в роли «единого окна».</li>
          </ul>
        </div>
        <div class="card pad">
          <h3 style="margin:0 0 var(--space-4) 0">Факты и направления</h3>
          <div class="grid grid-3">
            <div class="card pad" style="padding:var(--space-4)"><div class="fact"><svg class="ico ico-cad" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 7l9-4 9 4-9 4-9-4z"/><path d="M3 7v10l9 4 9-4V7"/></svg><div><div class="soft" style="font-size:12px">3D‑моделирование</div><div>CAD/CAE</div></div></div></div>
            <div class="card pad" style="padding:var(--space-4)"><div class="fact"><svg class="ico ico-scan" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 5h16"/><path d="M4 12h16"/><path d="M4 19h16"/></svg><div><div class="soft" style="font-size:12px">3D‑сканирование</div><div>оптика/лазер</div></div></div></div>
            <div class="card pad" style="padding:var(--space-4)"><div class="fact"><svg class="ico ico-print" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 4h12v6H6z"/><path d="M12 10v6m0 0l3 3m-3-3l-3 3"/></svg><div><div class="soft" style="font-size:12px">3D‑печать</div><div>FDM/DLP/SLA</div></div></div></div>
            <div class="card pad" style="padding:var(--space-4)"><div class="fact"><svg class="ico ico-xr" viewBox="0 0 24 24" aria-hidden="true"><rect x="3" y="7" width="18" height="10" rx="3"/><path d="M8 12h2m4 0h2"/></svg><div><div class="soft" style="font-size:12px">XR</div><div>VR/AR/MR</div></div></div></div>
            <div class="card pad" style="padding:var(--space-4)"><div class="fact"><svg class="ico ico-rev" viewBox="0 0 24 24" aria-hidden="true"><path d="M7 7l-4 4 4 4"/><path d="M17 7l4 4-4 4"/></svg><div><div class="soft" style="font-size:12px">Реверс</div><div>CAD по скану</div></div></div></div>
            <div class="card pad" style="padding:var(--space-4)"><div class="fact"><svg class="ico ico-edu" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h14a4 4 0 014 4v8H7a4 4 0 01-4-4z"/><path d="M7 6v12"/></svg><div><div class="soft" style="font-size:12px">ДПО</div><div>48+ ч</div></div></div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- SERVICES -->
    <section id="services" class="wrap reveal">
      <div style="display:flex;align-items:end;justify-content:space-between;gap:var(--space-3)">
        <h2 style="font-size:clamp(22px,3vw,28px)">Услуги</h2>
        <span class="soft" style="font-size:12px">Цены ориентировочные, «от»</span>
      </div>
      <div class="grid grid-3" style="margin-top:var(--space-6)">
        <div class="card service">
          <h3 style="display:flex;align-items:center;gap:8px"><svg class="ico svc-ico svc-cad" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 7l9-4 9 4-9 4-9-4z"/><path d="M3 7v10l9 4 9-4V7"/></svg>3D‑моделирование (CAD)</h3>
          <div class="soft">Инженерное и художественное</div>
          <div class="sep"></div>
          <div style="display:flex;align-items:center;justify-content:space-between"><span>от 1 000 ₽</span><a href="#contact" class="btn">Заказать ▸</a></div>
        </div>
        <div class="card service">
          <h3 style="display:flex;align-items:center;gap:8px"><svg class="ico svc-ico svc-scan" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 6h16"/><path d="M4 12h16"/><path d="M4 18h16"/></svg>3D‑сканирование</h3>
          <div class="soft">Оптическое и лазерное</div>
          <div class="sep"></div>
          <div style="display:flex;align-items:center;justify-content:space-between"><span>от 2 000 ₽</span><a href="#contact" class="btn">Заказать ▸</a></div>
        </div>
        <div class="card service">
          <h3 style="display:flex;align-items:center;gap:8px"><svg class="ico svc-ico svc-print" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 4h12v6H6z"/><path d="M12 10v6m0 0l3 3m-3-3l-3 3"/></svg>3D‑печать (FDM, DLP)</h3>
          <div class="soft">Прототипы и мелкосерийка</div>
          <div class="sep"></div>
          <div style="display:flex;align-items:center;justify-content:space-between"><span>от 500 ₽</span><a href="#contact" class="btn">Заказать ▸</a></div>
        </div>
        <div class="card service">
          <h3 style="display:flex;align-items:center;gap:8px"><svg class="ico svc-ico svc-rev" viewBox="0 0 24 24" aria-hidden="true"><path d="M7 7l-4 4 4 4"/><path d="M17 7l4 4-4 4"/></svg>Реверс‑инжиниринг</h3>
          <div class="soft">CAD по сканам, отклонения</div>
          <div class="sep"></div>
          <div style="display:flex;align-items:center;justify-content:space-between"><span>от 5 000 ₽</span><a href="#contact" class="btn">Заказать ▸</a></div>
        </div>
        <div class="card service">
          <h3 style="display:flex;align-items:center;gap:8px"><svg class="ico svc-ico svc-design" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 16C8 9 16 9 20 16"/><circle cx="12" cy="12" r="1"/></svg>Промышленный дизайн</h3>
          <div class="soft">Дизайн + прототип</div>
          <div class="sep"></div>
          <div style="display:flex;align-items:center;justify-content:space-between"><span>от 50 000 ₽</span><a href="#contact" class="btn">Заказать ▸</a></div>
        </div>
        <div class="card service">
          <h3 style="display:flex;align-items:center;gap:8px"><svg class="ico svc-ico svc-motion" viewBox="0 0 24 24" aria-hidden="true"><path d="M5 5h14v14H5z"/><path d="M10 9l5 3-5 3z"/></svg>Моушен‑дизайн</h3>
          <div class="soft">CG‑ролики, визуализации</div>
          <div class="sep"></div>
          <div style="display:flex;align-items:center;justify-content:space-between"><span>от 10 000 ₽</span><a href="#contact" class="btn">Заказать ▸</a></div>
        </div>
        <div class="card service">
          <h3 style="display:flex;align-items:center;gap:8px"><svg class="ico svc-ico svc-vr" viewBox="0 0 24 24" aria-hidden="true"><rect x="3" y="7" width="18" height="10" rx="3"/><path d="M8 12h2m4 0h2"/></svg>VR/AR/MR</h3>
          <div class="soft">Интерактив и демо‑стенды</div>
          <div class="sep"></div>
          <div style="display:flex;align-items:center;justify-content:space-between"><span>от 50 000 ₽</span><a href="#contact" class="btn">Заказать ▸</a></div>
        </div>
        <div class="card service">
          <h3 style="display:flex;align-items:center;gap:8px"><svg class="ico svc-ico svc-edu" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h14a4 4 0 014 4v8H7a4 4 0 01-4-4z"/><path d="M7 6v12"/></svg>Курсы ДПО (РГСУ)</h3>
          <div class="soft">48+ академ. часов</div>
          <div class="sep"></div>
          <div style="display:flex;align-items:center;justify-content:space-between"><span>от 68 000 ₽</span><a href="#contact" class="btn">Заказать ▸</a></div>
        </div>
      </div>
    </section>

    <!-- ESTIMATOR -->
    <section id="estimator" class="wrap reveal est">
      <h2 style="font-size:clamp(22px,3vw,28px)">Быстрый расчёт 3D‑печати</h2>
      <p class="muted">Приблизительная оценка по объёму модели и технологии. Итог подтвердим после слайсера.</p>
      <div class="card pad" style="margin-top:14px">
        <div class="row">
          <div>
            <div class="soft" style="font-size:12px">Технология</div>
            <div style="display:flex;gap:var(--space-2);margin-top:8px">
              <button class="chip active" data-tech="FDM">FDM</button>
              <button class="chip" data-tech="SLA">SLA</button>
              <button class="chip" data-tech="SLS">SLS</button>
            </div>
          </div>
          <div>
            <div class="soft" style="font-size:12px">Объём модели (см³)</div>
            <input id="vol" type="range" min="1" max="500" value="50" class="range" />
            <div class="soft" style="margin-top:6px">Текущее значение: <span id="volv">50</span> см³</div>
          </div>
        </div>
        <div class="summary">
          <label class="soft" style="display:flex;align-items:center;gap:var(--space-2)"><input id="rush" type="checkbox"/> Срочно (≈ +30%)</label>
          <div style="text-align:right">
            <div class="soft" style="font-size:12px">Оценка</div>
            <div id="price" style="font-size:28px;font-weight:600">≈ 400 ₽</div>
          </div>
        </div>
      </div>
      <div class="soft" style="font-size:12px;margin-top:8px">* Средние тарифы по технологиям. Постобработка и срочность считаются отдельно.</div>
      <div style="margin-top:14px;display:flex;gap:var(--space-2)"><a class="btn btn--primary" href="#contact">Получить точное КП</a><button class="btn" id="print">Печать КП</button></div>
    </section>

    <!-- PROJECTS -->
    <section id="projects" class="wrap reveal">
      <div style="display:flex;gap:var(--space-3);align-items:end;justify-content:space-between;flex-wrap:wrap">
        <h2 style="font-size:clamp(22px,3vw,28px)">Проекты</h2>
        <div class="tools">
          <span class="soft" style="font-size:14px">Фильтр:</span>
          <button class="tag active" data-tag="Все">Все</button>
          <button class="tag" data-tag="CAD">CAD</button>
          <button class="tag" data-tag="Сканирование">Сканирование</button>
          <button class="tag" data-tag="Печать">Печать</button>
          <button class="tag" data-tag="Реверс">Реверс</button>
          <button class="tag" data-tag="VR/AR">VR/AR</button>
          <button class="tag" data-tag="Дизайн">Дизайн</button>
          <div class="search">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="1.5"/><path d="M20 20l-3.5-3.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            <input id="q" placeholder="Поиск по проектам"/>
          </div>
        </div>
      </div>
      <div id="proj" class="grid grid-3" style="margin-top:var(--space-6)"></div>
    </section>

    <!-- BLOG -->
    <section id="blog" class="wrap reveal">
      <div style="display:flex;align-items:end;justify-content:space-between;gap:var(--space-3)">
        <h2 style="font-size:clamp(22px,3vw,28px)">Блог</h2>
        <div class="search"><input id="bq" placeholder="Поиск по блогу"/></div>
      </div>
      <div id="bloglist" class="grid grid-3" style="margin-top:var(--space-6)"></div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="wrap reveal">
      <div class="grid grid-2">
        <div>
          <h2 style="font-size:clamp(22px,3vw,28px)">Начнём проект</h2>
          <p class="muted">Опишите задачу — пришлём КП и сроки.</p>
          <div style="margin-top:12px;display:grid;gap:var(--space-2);font-size:14px">
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <a href="tel:+79959009141">📞 +7 (995) 900‑91‑41</a>
              <button class="copy" data-copy="+7 (995) 900-91-41" type="button">Копировать</button>
            </div>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <a href="mailto:info@step3d.tech">✉️ info@step3d.tech</a>
              <button class="copy" data-copy="info@step3d.tech" type="button">Копировать</button>
            </div>
            <a href="https://t.me/STEP_3D_Lab" target="_blank" rel="noopener noreferrer">💬 t.me/STEP_3D_Lab</a>
          </div>
        </div>
        <div class="card pad">
          <h3 style="margin:0 0 10px 0">Короткая форма</h3>
          <form class="form" onsubmit="return false" id="lead">
            <div style="display:grid;gap:var(--space-3)">
              <input name="name" placeholder="Имя" required />
              <input name="contact" placeholder="Почта или Telegram" required />
              <textarea name="msg" rows="3" placeholder="Коротко о задаче" required></textarea>
              <button class="btn btn--primary" id="send">Отправить</button>
              <div class="soft" style="font-size:12px">Нажимая «Отправить», вы соглашаетесь с обработкой данных.</div>
            </div>
          </form>
        </div>
      </div>
    </section>
  </main>

  <!-- Mobile CTA + Modal -->
  <div id="cta" class="cta" hidden>
    <a class="btn btn--primary" href="#estimator">Калькулятор</a>
    <a class="btn" href="#contact">Заявка</a>
    <button class="btn" id="ctaSearch">Поиск</button>
  </div>
  <div id="modal" class="modal" hidden role="dialog" aria-modal="true">
    <div class="modal__inner card pad">
      <button class="modal__close" aria-label="Закрыть">✕</button>
      <div id="modalBody"></div>
    </div>
  </div>
  <!-- Command palette -->
  <div id="kbar" class="kbar" hidden>
    <div class="kbar__box">
      <div class="kbar__head">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="1.5"/><path d="M20 20l-3.5-3.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        <input id="kbarInput" class="kbar__input" placeholder="Поиск по сайту (⌘K)"/>
      </div>
      <div id="kbarList" class="kbar__list"></div>
    </div>
  </div>

  <footer>
    <div class="wrap" style="display:flex;gap:24px;align-items:flex-start;justify-content:space-between;flex-wrap:wrap">
      <div>
        <div class="brand" style="color:var(--fg)">Step3D</div>
        <p style="max-width:560px;margin:var(--space-2) 0 0 0">© <span id="y"></span> ООО «СТЕП_3Д». Все права защищены.</p>
      </div>
      <div style="font-size:14px"><div class="soft" style="font-size:12px">ИНН 9725161467 · ОГРН 1247700430449</div></div>
    </div>
  </footer>

  <script>
    // Reveal on scroll
    const io = new IntersectionObserver((entries)=>{ entries.forEach(e=>{ if(e.isIntersecting) e.target.classList.add('in') }) }, {threshold:.12});
    document.querySelectorAll('.reveal').forEach(el=> io.observe(el));

    // Section highlight in nav
    const sections=['about','services','estimator','projects','blog','contact'];
    const navLinks=[...document.querySelectorAll('.nav a.link')];
    const secIO=new IntersectionObserver((ents)=>{ ents.forEach(ent=>{ if(ent.isIntersecting){ navLinks.forEach(a=>{ const on=a.getAttribute('href')==='#'+ent.target.id; a.classList.toggle('active',on); a.setAttribute('aria-current',on?'page':'false'); }); } }) }, {rootMargin:'-40% 0px -55% 0px'});
    sections.forEach(id=>{ const s=document.getElementById(id); if(s) secIO.observe(s); });

    // Mobile nav toggle
    const navEl=document.querySelector('.nav'); const menuBtn=document.getElementById('menu');
    menuBtn?.addEventListener('click',()=>{ const open=navEl?.dataset.open==='true'; if(navEl){ navEl.dataset.open=String(!open); } menuBtn.setAttribute('aria-expanded',String(!open)); });
    document.querySelectorAll('.nav .links a').forEach(a=> a.addEventListener('click',()=>{ if(navEl){ navEl.dataset.open='false'; } menuBtn?.setAttribute('aria-expanded','false'); }));

    // 3D Canvas in hero (interactive wireframe torus)
    (function(){
      const cv=document.getElementById('fx3d'); if(!cv) return; const ctx=cv.getContext('2d');
      const reduce=window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      function resize(){ cv.width=window.innerWidth; cv.height=Math.max(360,window.innerHeight*0.6); }
      window.addEventListener('resize',resize,{passive:true}); resize();
      let t=0,mx=0,my=0; window.addEventListener('mousemove',e=>{ const r=cv.getBoundingClientRect(); mx=(e.clientX-r.left)/r.width-0.5; my=(e.clientY-r.top)/r.height-0.5; },{passive:true});
      function proj(x,y,z,s){ const f=3; const k=s/(z+f); return [x*k,y*k]; }
      function draw(dt){ t+=dt; const w=cv.width,h=cv.height,s=Math.min(w,h)/2.3; ctx.clearRect(0,0,w,h); ctx.save(); ctx.translate(w/2,h/2); ctx.globalAlpha=.6; ctx.lineWidth=1; ctx.strokeStyle=getComputedStyle(document.documentElement).getPropertyValue('--fg')||'#000'; const R=1.15,r=.42,U=36,V=18; const rx=t*.6+my*1.2,ry=t*.4+mx*1.2,rz=t*.2; for(let i=0;i<=U;i++){ ctx.beginPath(); for(let j=0;j<=V;j++){ const u=i/U*Math.PI*2,v=j/V*Math.PI*2; let x=(R+r*Math.cos(v))*Math.cos(u); let y=(R+r*Math.cos(v))*Math.sin(u); let z=r*Math.sin(v); let X=x,Y=y*Math.cos(rx)-z*Math.sin(rx),Z=y*Math.sin(rx)+z*Math.cos(rx); let X2=X*Math.cos(ry)+Z*Math.sin(ry),Y2=Y,Z2=-X*Math.sin(ry)+Z*Math.cos(ry); let X3=X2*Math.cos(rz)-Y2*Math.sin(rz),Y3=X2*Math.sin(rz)+Y2*Math.cos(rz),Z3=Z2; const p=proj(X3,Y3,Z3,s); if(j===0) ctx.moveTo(p[0],p[1]); else ctx.lineTo(p[0],p[1]); } ctx.stroke(); }
        for(let j=0;j<=V;j++){ ctx.beginPath(); for(let i=0;i<=U;i++){ const u=i/U*Math.PI*2,v=j/V*Math.PI*2; let x=(R+r*Math.cos(v))*Math.cos(u); let y=(R+r*Math.cos(v))*Math.sin(u); let z=r*Math.sin(v); let X=x,Y=y*Math.cos(rx)-z*Math.sin(rx),Z=y*Math.sin(rx)+z*Math.cos(rx); let X2=X*Math.cos(ry)+Z*Math.sin(ry),Y2=Y,Z2=-X*Math.sin(ry)+Z*Math.cos(ry); let X3=X2*Math.cos(rz)-Y2*Math.sin(rz),Y3=X2*Math.sin(rz)+Y2*Math.cos(rz),Z3=Z2; const p=proj(X3,Y3,Z3,s); if(i===0) ctx.moveTo(p[0],p[1]); else ctx.lineTo(p[0],p[1]); } ctx.stroke(); } ctx.restore(); }
      function frame(){ if(reduce||document.hidden){ draw(0); return; } draw(0.012); requestAnimationFrame(frame); }
      document.addEventListener('visibilitychange',()=>{ if(!document.hidden) requestAnimationFrame(frame); }); frame();
    })();

    // Telegram cover (Step3D logo)
    (function(){ const a=document.getElementById('tgCover'); if(!a) return; const svg=`
<svg xmlns='http://www.w3.org/2000/svg' width='1280' height='640'>
  <rect width='100%' height='100%' fill='white'/>
  <g fill='none' stroke='black' opacity='0.06'>
    ${Array.from({length:64}).map((_,i)=>`<line x1='${i*20}' y1='0' x2='${i*20}' y2='640'/>`).join('')}
    ${Array.from({length:32}).map((_,i)=>`<line x1='0' y1='${i*20}' x2='1280' y2='${i*20}'/>`).join('')}
  </g>
  <text x='50%' y='50%' font-family='Inter,Arial,Helvetica,sans-serif' font-size='144' font-weight='700' fill='black' text-anchor='middle' dominant-baseline='central'>Step3D</text>
  <text x='50%' y='62%' font-family='Inter,Arial,Helvetica,sans-serif' font-size='28' fill='black' text-anchor='middle'>Агрегатор 3D‑услуг • step3d.tech</text>
  <text x='50%' y='74%' font-family='Inter,Arial,Helvetica,sans-serif' font-size='20' fill='black' text-anchor='middle'>#мечтай  #учись  #твори  #вдохновляй</text>
</svg>`; const blob=new Blob([svg],{type:'image/svg+xml'}); const url=URL.createObjectURL(blob); a.href=url; })();

    // Theme toggle (auto → light → dark)
    (function(){ const root=document.documentElement; const btn=document.getElementById('theme'); const key='theme-step3d'; function apply(mode){ const sysDark=window.matchMedia('(prefers-color-scheme: dark)').matches; const useDark=mode==='auto'?sysDark:(mode==='dark'); root.classList.toggle('dark',useDark); root.dataset.theme=mode; if(btn){ btn.textContent=mode==='dark'?'☾':mode==='light'?'☼':'◐'; btn.setAttribute('aria-label','Тема: '+mode); } }
      let mode=localStorage.getItem(key)||'auto'; apply(mode); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change',()=>{ if((localStorage.getItem(key)||'auto')==='auto') apply('auto'); }); btn?.addEventListener('click',()=>{ mode=mode==='auto'?'light':mode==='light'?'dark':'auto'; localStorage.setItem(key,mode); apply(mode); updateThemeMeta(); toast('Тема: '+mode); }); })();

    // Scroll progress + mobile CTA
    (function(){ const bar=document.getElementById('progress'); const cta=document.getElementById('cta'); function onScroll(){ const h=document.documentElement; const max=h.scrollHeight-h.clientHeight; const p=max>0?(h.scrollTop/max)*100:0; bar.style.width=p+'%'; cta.hidden=h.scrollTop<420; } document.addEventListener('scroll',onScroll,{passive:true}); onScroll(); })();

    // Estimator (basic)
    const RATES={FDM:8,SLA:68,SLS:105}; let tech='FDM'; let vol=50; let rush=false; const priceEl=document.getElementById('price'); const volEl=document.getElementById('vol'); const volValEl=document.getElementById('volv'); const rushEl=document.getElementById('rush');
    function rf(n){return n.toLocaleString('ru-RU')} function calc(){ const base=vol*RATES[tech]; const k=rush?1.3:1; priceEl.textContent=`≈ ${rf(Math.round(base*k))} ₽`; }
    document.querySelectorAll('[data-tech]').forEach(btn=> btn.addEventListener('click',()=>{ tech=btn.getAttribute('data-tech'); document.querySelectorAll('[data-tech]').forEach(b=>b.classList.remove('active')); btn.classList.add('active'); calc(); }));
    volEl.addEventListener('input',e=>{ vol=+e.target.value; volValEl.textContent=vol; calc(); }); rushEl.addEventListener('change',e=>{ rush=e.target.checked; calc(); }); calc();

    // Projects data & rendering
    const PROJECTS=[
      {id:'kawasaki',title:'Композиционный обвес для Kawasaki Puccetti Racing (с Umatex/Росатом)',teaser:'Инжиниринг, CAD и прототипирование элементов обвеса под реальные нагрузки.',tags:['Дизайн','CAD','Печать'],kpi:'Снижение веса на 18%'},
      {id:'bot',title:'Step3D Bot — чат‑бот для заказа 3D‑услуг',teaser:'Интерфейс в Telegram, автооценка и маршрутизация задач.',tags:['VR/AR','Реверс','CAD'],kpi:'КП за 1–2 минуты'},
      {id:'xr',title:'Step3D XR — лаборатория VR/AR/MR‑решений',teaser:'Интерактивные демо‑стенды, обучение и промышленный маркетинг.',tags:['VR/AR','Дизайн']},
      {id:'reverse',title:'Реверс‑инжиниринг точных деталей',teaser:'Скан → CAD по облаку → анализ отклонений. Полная 2D/3D‑документация.',tags:['Реверс','Сканирование','CAD']},
      {id:'fdm',title:'FDM‑серия корпусов для электроники',teaser:'Стабильная мелкосерия на нескольких принтерах, сборка и постобработка.',tags:['Печать','Дизайн']},
      {id:'sla',title:'SLA‑мастер‑модели с высокой детализацией',teaser:'Гладкая поверхность, тонкие стенки, готово под силиконовые формы.',tags:['Печать']}
    ];
    let activeTag='Все'; let query=''; const projEl=document.getElementById('proj');
    function renderProjects(){ const res=PROJECTS.filter(p=>{ const byTag=activeTag==='Все'||p.tags.includes(activeTag); const text=(p.title+' '+p.teaser+' '+p.tags.join(' ')).toLowerCase(); const byQ=query?text.includes(query.toLowerCase()):true; return byTag&&byQ; }); projEl.innerHTML=res.map(p=>`<div class="card project"><div class="img"><div style="position:absolute;inset:0;display:grid;place-items:center;color:rgba(0,0,0,.35)">▦</div></div><div class="pad" style="padding:var(--space-6)"><div class="badges">${p.tags.map(t=>`<span class="badge">${t}</span>`).join('')}</div><h3 style="margin:10px 0 4px 0">${p.title}</h3><div class="soft" style="font-size:14px">${p.teaser}</div><div style="display:flex;align-items:center;justify-content:space-between;margin-top:12px"><span class="soft" style="font-size:12px">${p.kpi??''}</span><a class="btn" href="#contact">Подробнее ▸</a></div></div></div>`).join(''); }
    document.querySelectorAll('.tag').forEach(btn=> btn.addEventListener('click',()=>{ document.querySelectorAll('.tag').forEach(b=>b.classList.remove('active')); btn.classList.add('active'); activeTag=btn.getAttribute('data-tag'); renderProjects(); }));
    document.getElementById('q').addEventListener('input',e=>{ query=e.target.value; renderProjects(); }); renderProjects();

    // Blog
    const POSTS=[
      {id:'cp-fast',title:'Как мы сокращаем путь к КП до 1–2 минут',date:'2024‑07‑19',excerpt:'AI‑модуль Step3D_system автоматически оценивает трудоёмкость, подбирает исполнителей и формирует прозрачное КП. Рассказываем архитектуру и гайдлайны.'},
      {id:'fdm-vs-sla',title:'FDM vs SLA: когда и что выбирать',date:'2024‑08‑05',excerpt:'Сравниваем стоимость на см³, качество поверхности и сроки. Пару практических правил, чтобы не переплачивать.'},
      {id:'reverse-practice',title:'Реверс‑инжиниринг: от скана до CAD',date:'2024‑08‑12',excerpt:'Пайплайн: скан → очистка → совмещение → NURBS/CAD → отклонения → выпуск КД. Советы по точности и материалам.'}
    ];
    const blogEl=document.getElementById('bloglist');
    function renderBlog(qb=''){ blogEl.innerHTML=POSTS.filter(p=> (p.title+' '+p.excerpt).toLowerCase().includes(qb.toLowerCase())).map(p=>`<article class="post card pad"><div style="display:flex;align-items:center;justify-content:space-between"><time datetime="${p.date}">${p.date}</time><span class="badge">Новое</span></div><h3 style="margin:10px 0 4px 0">${p.title}</h3><div class="soft" style="font-size:14px">${p.excerpt}</div><div style="margin-top:10px"><a class="btn" href="#blog">Читать ▸</a></div></article>`).join(''); }
    renderBlog(); document.getElementById('bq').addEventListener('input',e=> renderBlog(e.target.value));

    // Year & misc
    document.getElementById('y').textContent=new Date().getFullYear();
    document.getElementById('progress').addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}));

    // Toast helper
    function toast(msg){ const t=document.createElement('div'); t.className='toast'; t.textContent=msg; document.body.appendChild(t); setTimeout(()=>{t.remove();},2600); }

    // Share API
    document.getElementById('share')?.addEventListener('click',async()=>{ const data={title:'Step3D — агрегатор 3D‑услуг',text:'Посмотри Step3D: 3D‑моделирование, печать, сканирование, XR',url:location.href}; try{ if(navigator.share){ await navigator.share(data); } else { await navigator.clipboard.writeText(location.href); toast('Ссылка скопирована'); } }catch{ toast('Не удалось поделиться'); }});

    // Copy buttons
    document.querySelectorAll('.copy').forEach(btn=> btn.addEventListener('click',async()=>{ try{ await navigator.clipboard.writeText(btn.dataset.copy||''); toast('Скопировано'); }catch{ toast('Не удалось скопировать'); } }));

    // Persist lead form + submit
    const lead=document.getElementById('lead');
    lead?.querySelectorAll('input,textarea').forEach(el=>{ const k='lead_'+el.name; const v=localStorage.getItem(k); if(v) el.value=v; el.addEventListener('input',()=>localStorage.setItem(k,el.value)); });
    document.getElementById('send').addEventListener('click',()=>{ const fd=new FormData(document.getElementById('lead')); const payload=Object.fromEntries(fd.entries()); toast('Заявка отправлена'); console.log('Lead:',payload); });

    // Update theme-color meta on theme change
    function updateThemeMeta(){ const dark=document.documentElement.classList.contains('dark'); document.querySelectorAll('meta[name="theme-color"]').forEach(m=> m.setAttribute('content',dark?'#0b0b0b':'#ffffff')); }

    // Print handler
    document.getElementById('print')?.addEventListener('click',()=> window.print());

    // Command palette (kbar) logic
    (function(){
      const kbar=document.getElementById('kbar'); const input=document.getElementById('kbarInput'); const list=document.getElementById('kbarList'); const btn=document.getElementById('searchBtn'); const btnMobile=document.getElementById('ctaSearch');
      let items=[]; let sel=0;
      function build(){ items=[
        {title:'О нас',href:'#about',type:'Раздел'},
        {title:'Услуги',href:'#services',type:'Раздел'},
        {title:'Калькулятор',href:'#estimator',type:'Раздел'},
        {title:'Проекты',href:'#projects',type:'Раздел'},
        {title:'Блог',href:'#blog',type:'Раздел'},
        {title:'Контакты',href:'#contact',type:'Раздел'},
        {title:'3D‑моделирование (CAD)',href:'#services',type:'Услуга'},
        {title:'3D‑сканирование',href:'#services',type:'Услуга'},
        {title:'3D‑печать',href:'#services',type:'Услуга'},
        {title:'Реверс‑инжиниринг',href:'#services',type:'Услуга'},
        {title:'Промышленный дизайн',href:'#services',type:'Услуга'},
        {title:'Моушен‑дизайн',href:'#services',type:'Услуга'},
        {title:'VR/AR/MR',href:'#services',type:'Услуга'},
        {title:'Курсы ДПО (РГСУ)',href:'#services',type:'Услуга'}
      ].concat(PROJECTS.map(p=>({title:p.title,sub:p.teaser,href:'#projects',type:'Проект'}))).concat(POSTS.map(p=>({title:p.title,sub:p.excerpt,href:'#blog',type:'Пост'}))); }
      function open(){ build(); kbar.hidden=false; input.value=''; render(''); setTimeout(()=>input.focus(),0); }
      function close(){ kbar.hidden=true; }
      function render(q){ const qq=q.toLowerCase().trim(); sel=0; const view=items.map(it=>{ const hay=(it.title+' '+(it.sub||'')).toLowerCase(); let score=!qq?2:hay.includes(qq)?1+(it.title.toLowerCase().startsWith(qq)?1:0):0; return {...it,score}; }).filter(i=>i.score>0).sort((a,b)=>b.score-a.score).slice(0,10); list.innerHTML=view.map((i,idx)=>`<div class="kbar__item${idx===0?' active':''}" data-href="${i.href}" tabindex="0"><div><div>${i.title}</div>${i.sub?`<div class='soft' style='font-size:12px'>${i.sub}</div>`:''}</div><div class="kbar__type">${i.type}</div></div>`).join('')||'<div class="kbar__item">Ничего не найдено</div>'; }
      function onKey(e){ if((e.key==='k'&&(e.metaKey||e.ctrlKey))|| (e.key==='/'&&e.target.tagName!=='INPUT'&&e.target.tagName!=='TEXTAREA')){ e.preventDefault(); open(); return; } if(kbar.hidden) return; if(e.key==='Escape'){ close(); return; } const els=[...list.querySelectorAll('.kbar__item[data-href]')]; if(!els.length) return; if(e.key==='ArrowDown'){ e.preventDefault(); sel=(sel+1)%els.length; els.forEach((el,i)=>el.classList.toggle('active',i===sel)); return; } if(e.key==='ArrowUp'){ e.preventDefault(); sel=(sel-1+els.length)%els.length; els.forEach((el,i)=>el.classList.toggle('active',i===sel)); return; } if(e.key==='Home'){ e.preventDefault(); sel=0; els.forEach((el,i)=>el.classList.toggle('active',i===sel)); return; } if(e.key==='End'){ e.preventDefault(); sel=els.length-1; els.forEach((el,i)=>el.classList.toggle('active',i===sel)); return; } if(e.key==='Enter'){ e.preventDefault(); const href=els[sel].getAttribute('data-href'); if(href){ location.hash=href; } close(); } }
      input.addEventListener('input',e=>render(e.target.value)); list.addEventListener('click',e=>{ const el=e.target.closest('.kbar__item'); if(!el) return; const href=el.getAttribute('data-href'); if(href){ location.hash=href; } close(); });
      document.addEventListener('keydown',onKey); btn?.addEventListener('click',open); btnMobile?.addEventListener('click',open); kbar.addEventListener('click',e=>{ if(e.target.id==='kbar') close(); });
      kbar.addEventListener('keydown',(e)=>{ if(kbar.hidden) return; if(e.key==='Tab'){ const focusables=[input,...kbar.querySelectorAll('.kbar__item')]; let i=focusables.indexOf(document.activeElement); i=e.shiftKey?(i-1+focusables.length)%focusables.length:(i+1)%focusables.length; focusables[i].focus?.(); e.preventDefault(); }});
    })();

    // ---- Self-tests (non-blocking) ----
    try{ console.assert(document.querySelectorAll('.nav a.link').length>=6,'Nav links missing'); renderProjects(); console.assert(document.getElementById('proj').children.length>=1,'Projects did not render'); console.assert(document.getElementById('kbarInput'),'kbar input missing'); console.assert(document.getElementById('fx3d'),'fx3d missing'); const before=priceEl.textContent; volEl.value=String(+volEl.value+1); volEl.dispatchEvent(new Event('input')); console.assert(priceEl.textContent!==before,'Estimator did not update'); console.log('%cStep3D UI ready','color:green'); }catch(e){ console.warn('Self-tests failed:',e); }
  </script>
</body>
</html>
